<section class="orders-container">
  <h1 class="page-title">ğŸ“¦ Order Management</h1>

  <ng-container *ngIf="orders?.length; else noOrders">
    <h2 class="order-count">All Orders ({{ orders.length }})</h2>

    <div *ngFor="let order of orders" class="order-card">
      <div class="order-header">
        <h3>Order #{{ order._id }}</h3>
        <span class="status" [ngClass]="order.status">{{ order.status }}</span>
      </div>

      <div class="order-details">
        <p><strong>User:</strong> {{ order.user }}</p>
        <p><strong>Total:</strong> {{ order.TotalPrice | currency : 'EGP' }}</p>
        <p><strong>Placed:</strong> {{ order.orderedAt || order.createdAt | date : 'short' }}</p>
      </div>

      <!-- Dropdown Menu for Status Change -->
      <div class="status-update">
        <label for="status">Change Status:</label>
        <select
          id="status"
          [(ngModel)]="order.status"
          (change)="updateOrderStatus(order._id, order.status)"
        >
          <option value="pending">Pending</option>
          <option value="shipped">Shipped</option>
          <option value="delivered">Delivered</option>
          <option value="rejected">Rejected</option>
          <option value="cancelled">Cancelled</option>
        </select>
      </div>

      <div *ngIf="order.items?.length" class="order-items">
        <h4>Items ({{ order.items.length }})</h4>
        <ul>
          <li *ngFor="let it of order.items">
            <span class="product">ğŸ›ï¸ {{ it.product }}</span>
            <span class="qty">Qty: {{ it.quantity }}</span>
          </li>
        </ul>
      </div>
    </div>
  </ng-container>

  <ng-template #noOrders>
    <div class="no-orders">
      <p>ğŸ•Šï¸ No orders found yet.</p>
      <a routerLink="/marketplace" class="browse-btn">Browse Products</a>
    </div>
  </ng-template>
</section>
